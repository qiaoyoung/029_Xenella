
#import <Foundation/Foundation.h>

NSString *StringFromOutsideData(Byte *data);        


//: 已发送
Byte commonGuaranteeValue[] = {88, 9, 82, 5, 209, 147, 101, 96, 147, 61, 63, 151, 46, 47, 71};

//: 确认转发
Byte featurePairValue[] = {35, 12, 75, 11, 193, 190, 73, 79, 150, 57, 59, 156, 86, 99, 157, 99, 89, 157, 114, 97, 154, 68, 70, 171};

//: message_super_team
Byte commonMorningPreference[] = {33, 18, 51, 9, 151, 6, 175, 142, 142, 58, 50, 64, 64, 46, 52, 50, 44, 64, 66, 61, 50, 63, 44, 65, 50, 46, 58, 176};

//: 选择会话类型
Byte appDiscusEaseStockDevice[] = {52, 18, 81, 5, 208, 152, 47, 56, 149, 58, 88, 147, 107, 73, 151, 94, 76, 150, 96, 106, 148, 77, 58, 229};

//: contact_tag_fragment_cancel
Byte spacingMomentDecisionPreference[] = {41, 27, 37, 11, 152, 240, 206, 208, 113, 25, 217, 62, 74, 73, 79, 60, 62, 79, 58, 79, 60, 66, 58, 65, 77, 60, 66, 72, 64, 73, 79, 58, 62, 60, 73, 62, 64, 71, 7};

//: contact_fragment_group
Byte k_groupDevice[] = {12, 22, 7, 13, 126, 224, 35, 52, 129, 248, 243, 140, 185, 92, 104, 103, 109, 90, 92, 109, 88, 95, 107, 90, 96, 102, 94, 103, 109, 88, 96, 107, 104, 110, 105, 122};

//: 确认
Byte coreEvenName[] = {78, 6, 55, 6, 42, 92, 176, 106, 119, 177, 119, 109, 186};

//: %@.code:%zd
Byte commonBoyTimer[] = {39, 11, 98, 9, 13, 232, 229, 232, 240, 195, 222, 204, 1, 13, 2, 3, 216, 195, 24, 2, 67};

//: 取消
Byte styleAlbumMinHelper[] = {47, 6, 94, 8, 79, 178, 43, 217, 135, 49, 56, 136, 88, 42, 255};

//: 转发失败
Byte kMakerBarePlatform[] = {33, 12, 43, 13, 112, 17, 202, 224, 153, 224, 148, 146, 138, 189, 146, 129, 186, 100, 102, 186, 121, 134, 189, 137, 122, 128};

//: 确认转发给
Byte componentProtestFormat[] = {9, 15, 60, 7, 47, 63, 4, 171, 101, 114, 172, 114, 104, 172, 129, 112, 169, 83, 85, 171, 127, 93, 165};

//: watch_multiretweet_activity_person
Byte kUserId[] = {53, 34, 17, 10, 118, 76, 218, 63, 159, 140, 102, 80, 99, 82, 87, 78, 92, 100, 91, 99, 88, 97, 84, 99, 102, 84, 84, 99, 78, 80, 82, 99, 88, 101, 88, 99, 104, 78, 95, 84, 97, 98, 94, 93, 21};

// __DEBUG__
// __CLOSE_PRINT__
//
//  BambooMeasureTransformableRegion.m
// TreatLayoutExotic
//
//  Created by 丁文超 on 2020/3/19.
//  Copyright © 2020 NetEase. All rights reserved.
//

// __M_A_C_R_O__
//: #import "BambooMeasureTransformableRegion.h"
#import "BambooMeasureTransformableRegion.h"
//: #import "GetReplayQuick.h"
#import "GetReplayQuick.h"
//: #import "ScheduleArrayDelicate.h"
#import "ScheduleArrayDelicate.h"
//: #import "GetAdapterConsoleFetch.h"
#import "GetAdapterConsoleFetch.h"
//: #import "UIView+FleetInstanceHazeSignal.h"
#import "UIView+FleetInstanceHazeSignal.h"

//: @implementation BambooMeasureTransformableRegion
@implementation BambooMeasureTransformableRegion

//: + (instancetype)sharedManager
+ (instancetype)signatureNeed
{
    //: static dispatch_once_t onceToken;
    static dispatch_once_t onceToken;
    //: static BambooMeasureTransformableRegion *instance;
    static BambooMeasureTransformableRegion *instance;
    //: _dispatch_once(&onceToken, ^{
    _dispatch_once(&onceToken, ^{
        //: instance = [self.alloc init];
        instance = [self.alloc init];
    //: });
    });
    //: return instance;
    return instance;
}

//: - (void)forwardMessage:(NIMMessage *)message fromViewController:(UIViewController *)fromVC
- (void)track:(NIMMessage *)message plainspokenSession:(UIViewController *)fromVC
{
    //: UIAlertController *alertController = [UIAlertController alertControllerWithTitle:[IsletSavePreview getTextWithKey:@"选择会话类型"] message:nil preferredStyle:UIAlertControllerStyleActionSheet];
    UIAlertController *alertController = [UIAlertController alertControllerWithTitle:[IsletSavePreview being:StringFromOutsideData(appDiscusEaseStockDevice)] message:nil preferredStyle:UIAlertControllerStyleActionSheet];
    //: [alertController addAction:[UIAlertAction actionWithTitle:[IsletSavePreview getTextWithKey:@"watch_multiretweet_activity_person"] style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
    [alertController addAction:[UIAlertAction actionWithTitle:[IsletSavePreview being:StringFromOutsideData(kUserId)] style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
        //: DecentMuseTruthGrove *config = [[DecentMuseTruthGrove alloc] init];
        DecentMuseTruthGrove *config = [[DecentMuseTruthGrove alloc] init];
        //: config.needMutiSelected = NO;
        config.needMutiSelected = NO;
        //: ScheduleArrayDelicate *vc = [[ScheduleArrayDelicate alloc] initWithConfig:config];
        ScheduleArrayDelicate *vc = [[ScheduleArrayDelicate alloc] initWithExecute:config];
        //: vc.finshBlock = ^(NSArray *array, NSString *name, UIImage *avater){
        vc.finshBlock = ^(NSArray *array, NSString *name, UIImage *avater){
            //: NSString *userId = array.firstObject;
            NSString *userId = array.firstObject;
            //: NIMSession *session = [NIMSession session:userId type:NIMSessionTypeP2P];
            NIMSession *session = [NIMSession session:userId type:NIMSessionTypeP2P];
            //: [self forwardMessage:message toSession:session fromViewController:fromVC];
            [self risklessnessController:message comment:session roundDrag:fromVC];
        //: };
        };
        //: [vc show];
        [vc mistranslation];
    //: }]];
    }]];
    //: [alertController addAction:[UIAlertAction actionWithTitle:[IsletSavePreview getTextWithKey:@"contact_fragment_group"] style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
    [alertController addAction:[UIAlertAction actionWithTitle:[IsletSavePreview being:StringFromOutsideData(k_groupDevice)] style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
        //: RemoveHappyTimelineEqual *config = [[RemoveHappyTimelineEqual alloc] init];
        RemoveHappyTimelineEqual *config = [[RemoveHappyTimelineEqual alloc] init];
        //: config.teamType = OwlCollectorOceanNomal;
        config.teamType = OwlCollectorOceanNomal;
        //: ScheduleArrayDelicate *vc = [[ScheduleArrayDelicate alloc] initWithConfig:config];
        ScheduleArrayDelicate *vc = [[ScheduleArrayDelicate alloc] initWithExecute:config];
        //: vc.finshBlock = ^(NSArray *array, NSString *name, UIImage *avater){
        vc.finshBlock = ^(NSArray *array, NSString *name, UIImage *avater){
            //: NSString *teamId = array.firstObject;
            NSString *teamId = array.firstObject;
            //: NIMSession *session = [NIMSession session:teamId type:NIMSessionTypeTeam];
            NIMSession *session = [NIMSession session:teamId type:NIMSessionTypeTeam];
            //: [self forwardMessage:message toSession:session fromViewController:fromVC];
            [self risklessnessController:message comment:session roundDrag:fromVC];
        //: };
        };
        //: [vc show];
        [vc mistranslation];
    //: }]];
    }]];
    //: [alertController addAction:[UIAlertAction actionWithTitle:[IsletSavePreview getTextWithKey:@"message_super_team"] style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
    [alertController addAction:[UIAlertAction actionWithTitle:[IsletSavePreview being:StringFromOutsideData(commonMorningPreference)] style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
        //: RemoveHappyTimelineEqual *config = [[RemoveHappyTimelineEqual alloc] init];
        RemoveHappyTimelineEqual *config = [[RemoveHappyTimelineEqual alloc] init];
        //: config.teamType = OwlCollectorOceanSuper;
        config.teamType = OwlCollectorOceanSuper;
        //: ScheduleArrayDelicate *vc = [[ScheduleArrayDelicate alloc] initWithConfig:config];
        ScheduleArrayDelicate *vc = [[ScheduleArrayDelicate alloc] initWithExecute:config];
        //: vc.finshBlock = ^(NSArray *array, NSString *name, UIImage *avater){
        vc.finshBlock = ^(NSArray *array, NSString *name, UIImage *avater){
            //: NSString *teamId = array.firstObject;
            NSString *teamId = array.firstObject;
            //: NIMSession *session = [NIMSession session:teamId type:NIMSessionTypeSuperTeam];
            NIMSession *session = [NIMSession session:teamId type:NIMSessionTypeSuperTeam];
            //: [self forwardMessage:message toSession:session fromViewController:fromVC];
            [self risklessnessController:message comment:session roundDrag:fromVC];
        //: };
        };
        //: [vc show];
        [vc mistranslation];
    //: }]];
    }]];
    //: [alertController addAction:[UIAlertAction actionWithTitle:[IsletSavePreview getTextWithKey:@"contact_tag_fragment_cancel"] style:UIAlertActionStyleCancel handler:nil]];
    [alertController addAction:[UIAlertAction actionWithTitle:[IsletSavePreview being:StringFromOutsideData(spacingMomentDecisionPreference)] style:UIAlertActionStyleCancel handler:nil]];
    //: [fromVC presentViewController:alertController animated:YES completion:nil];
    [fromVC presentViewController:alertController animated:YES completion:nil];
}

//: - (void)forwardMessage:(NIMMessage *)message toSession:(NIMSession *)session fromViewController:(UIViewController *)fromVC
- (void)risklessnessController:(NIMMessage *)message comment:(NIMSession *)session roundDrag:(UIViewController *)fromVC
{
    //: NSString *name;
    NSString *name;
    //: if (session.sessionType == NIMSessionTypeP2P) {
    if (session.sessionType == NIMSessionTypeP2P) {
        //: GetAdapterConsoleFetch *option = [[GetAdapterConsoleFetch alloc] init];
        GetAdapterConsoleFetch *option = [[GetAdapterConsoleFetch alloc] init];
        //: option.session = session;
        option.session = session;
        //: name = [[TreatLayoutExotic sharedKit] infoByUser:session.sessionId option:option].showName;
        name = [[TreatLayoutExotic kitIn] optionStream:session.sessionId background:option].showName;
    }
    //: else if (session.sessionType == NIMSessionTypeTeam) {
    else if (session.sessionType == NIMSessionTypeTeam) {
        //: name = [[TreatLayoutExotic sharedKit] infoByTeam:session.sessionId option:nil].showName;
        name = [[TreatLayoutExotic kitIn] coveredOption:session.sessionId connection_strong:nil].showName;
    }
    //: else if (session.sessionType == NIMSessionTypeSuperTeam) {
    else if (session.sessionType == NIMSessionTypeSuperTeam) {
        //: name = [[TreatLayoutExotic sharedKit] infoBySuperTeam:session.sessionId option:nil].showName;
        name = [[TreatLayoutExotic kitIn] noExcludeOption:session.sessionId notice:nil].showName;
    }
    //: NSString *tip = [NSString stringWithFormat:@"%@ %@ ?", NSLocalizedString(@"确认转发给", nil), name];
    NSString *tip = [NSString stringWithFormat:@"%@ %@ ?", NSLocalizedString(StringFromOutsideData(componentProtestFormat), nil), name];
    //: UIAlertController *alertController = [UIAlertController alertControllerWithTitle:NSLocalizedString(@"确认转发", nil) message:tip preferredStyle:UIAlertControllerStyleAlert];
    UIAlertController *alertController = [UIAlertController alertControllerWithTitle:NSLocalizedString(StringFromOutsideData(featurePairValue), nil) message:tip preferredStyle:UIAlertControllerStyleAlert];
    //: [alertController addAction:[UIAlertAction actionWithTitle:NSLocalizedString(@"取消", nil) style:UIAlertActionStyleCancel handler:nil]];
    [alertController addAction:[UIAlertAction actionWithTitle:NSLocalizedString(StringFromOutsideData(styleAlbumMinHelper), nil) style:UIAlertActionStyleCancel handler:nil]];
    //: [alertController addAction:[UIAlertAction actionWithTitle:NSLocalizedString(@"确认", nil) style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
    [alertController addAction:[UIAlertAction actionWithTitle:NSLocalizedString(StringFromOutsideData(coreEvenName), nil) style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
        //: NSError *error = nil;
        NSError *error = nil;
        //: if (message.session) {
        if (message.session) {
            //: [[NIMSDK sharedSDK].chatManager forwardMessage:message toSession:session error:&error];
            [[NIMSDK sharedSDK].chatManager forwardMessage:message toSession:session error:&error];
        //: } else {
        } else {
            //: [[NIMSDK sharedSDK].chatManager sendMessage:message toSession:session error:&error];
            [[NIMSDK sharedSDK].chatManager sendMessage:message toSession:session error:&error];
        }
        //: if (error) {
        if (error) {
            //: NSString *errorMessage = [NSString stringWithFormat:@"%@.code:%zd", NSLocalizedString(@"转发失败", nil), error.code];
            NSString *errorMessage = [NSString stringWithFormat:StringFromOutsideData(commonBoyTimer), NSLocalizedString(StringFromOutsideData(kMakerBarePlatform), nil), error.code];
            //: [fromVC.view nim_showToast:errorMessage duration:2.0];
            [fromVC.view ratioDestination:errorMessage exhibitOrDuration:2.0];
        //: } else {
        } else {
            //: [fromVC.view nim_showToast:NSLocalizedString(@"已发送", nil) duration:2.0];
            [fromVC.view ratioDestination:NSLocalizedString(StringFromOutsideData(commonGuaranteeValue), nil) exhibitOrDuration:2.0];
        }
    //: }]];
    }]];
    //: [fromVC presentViewController:alertController animated:YES completion:nil];
    [fromVC presentViewController:alertController animated:YES completion:nil];
}

//: @end
@end

Byte * OutsideDataToCache(Byte *data) {
    int memoryAdd = data[0];
    int morningTime = data[1];
    Byte rabbinate = data[2];
    int cupAffair = data[3];
    if (!memoryAdd) return data + cupAffair;
    for (int i = cupAffair; i < cupAffair + morningTime; i++) {
        int value = data[i] + rabbinate;
        if (value > 255) {
            value -= 256;
        }
        data[i] = value;
    }
    data[0] = 0;
    data[cupAffair + morningTime] = 0;
    return data + cupAffair;
}

NSString *StringFromOutsideData(Byte *data) {
    return [NSString stringWithUTF8String:(char *)OutsideDataToCache(data)];
}
